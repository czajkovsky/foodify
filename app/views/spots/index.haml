.container
  - if current_client? && current_user.has_spot?
    .panel.panel-default
      .panel-heading
        %h3.panel-title= "Your spot: #{my_spot.name}"
      .panel-body
        .row
          .col-xs-12.col-sm-6
            %ul.list-group
              %li.list-group-item
                %strong Balance
                = my_spot.balance
              %li.list-group-item
                %strong State
                %span{ class: my_spot.decorate.state_class }= my_spot.state
          .col-xs-12.col-sm-6
            - if my_spot.decorate.has_waiter?
              .list-group
                = link_to 'New order', '#', class: 'list-group-item'
                = link_to 'Finish', close_spot_path(my_spot), method: :put, class: 'list-group-item', data: { confirm: 'Are you sure?' }
            - else
              .list-group
                = link_to "I don't want to wait! Close my spot", close_spot_path(my_spot), method: :put, class: 'list-group-item', data: { confirm: 'Are you sure?' }
              .panel.panel-warning
                .panel-heading
                  %h3.panel-title Why I can't make oders?
                .panel-body Please wait for waiter assignment
  - if current_waiter?
    %h1
      You have currently
      %span.label.label-default= my_spots.count
      = 'spot'.pluralize(my_spots.count)
    .row
      - my_spots.each do |s|
        .col-xs-12.col-sm-6
          .panel{ class: s.decorate.panel_class }
            .panel-heading
              %h3.panel-title= s.name
            .panel-body
              %ul.list-group
                %li.list-group-item
                  %strong Balance
                  = s.balance
  .row
    .col-xs-12
      %h1 All spots
  .row
    .col-xs-12
      %table.table.table-striped.table-responsive
        %thead
          %th Name
          %th State
          %th Actions
        %tbody.table-hover
          - spots.each do |s|
            %tr
              %td= s.name
              %td
                %span{ class: s.decorate.state_class }= s.state
              %td
                - if current_worker?
                  - if current_waiter? and s.pending?
                    = link_to "I'll handle this!", handle_spot_path(s), method: :put, class: 'btn btn-default pull-right'
                  = link_to 'Show', s, class: 'btn btn-default pull-right'
                  = link_to 'Edit', edit_spot_path(s), class: 'btn btn-default pull-right'
                  = link_to 'Destroy', s, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-default pull-right'
                - else
                  - if !current_user.has_spot? and !s.has_client?
                    = link_to 'I want this spot!', join_spot_path(s), method: :put, class: 'btn btn-default pull-right'

  - if current_worker?
    .row.admin-table
      .col-xs-12
        = link_to 'New Spot', new_spot_path, class: 'btn btn-default'
